# SPDX-FileCopyrightText: 2025 Digg - Agency for Digital Government
#
# SPDX-License-Identifier: CC0-1.0

name: Release Dev Workflow

on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  # Build Android app with signing
  build:
    uses: diggsweden/reusable-ci/.github/workflows/build-gradle-app.yml@425ebfec93eed03cc0ec6040ee555257853d326b # v2.5.0
    permissions:
      contents: read
    secrets: inherit
    with:
      java-version: "21"
      build-module: "app"
      gradle-tasks: "assembleDemoRelease bundleDemoRelease"
      enable-signing: true
      artifact-name: "wallet-android-demo"

  # Publish to Google Play internal track
  publish-google-play:
    needs: build
    uses: diggsweden/reusable-ci/.github/workflows/publish-google-play.yml@425ebfec93eed03cc0ec6040ee555257853d326b # v2.5.0
    permissions:
      contents: read
    secrets: inherit
    with:
      aab-artifact-name: "wallet-android-demo"
      package-name: "se.digg.wallet.demo"
      track: "internal"
      status: "completed"
